using System;
using System.IO;
using Aspose.Pdf;
using Aspose.Pdf.Annotations;
using Aspose.Pdf.Facades;
using System.Drawing;

namespace Examples.Core.AsposePdfFacades.Annotations;

/// <summary>
/// Demonstrates updating annotations in a PDF using Aspose.Pdf.Facades.
/// </summary>
public class UpdateAnnotations
{
    public static void Run()
    {
        try
        {
            // Determine input and output directories relative to the application base directory.
            string baseDir = AppContext.BaseDirectory;
            string inputDir = Path.Combine(baseDir, "data", "inputs");
            string outputDir = Path.Combine(baseDir, "data", "outputs");

            // Ensure output directory exists.
            Directory.CreateDirectory(outputDir);

            // Input and output file paths.
            string inputPath = Path.Combine(inputDir, "input.pdf");
            string outputPath = Path.Combine(outputDir, "output_out.pdf");

            // Open document using PdfAnnotationEditor.
            var annotationEditor = new PdfAnnotationEditor();
            annotationEditor.BindPdf(inputPath);

            // Create a FreeTextAnnotation on the first page.
            var annotation = new FreeTextAnnotation(
                annotationEditor.Document.Pages[1],
                new Rectangle(200, 400, 400, 600),
                new DefaultAppearance("TimesNewRoman", 14, Color.Orange));

            annotation.Modified = DateTime.Now;
            annotation.Contents = "Contents...";
            annotation.Subject = "Subject";
            annotation.Color = Color.Green;

            // Modify annotation on page 1.
            annotationEditor.ModifyAnnotations(1, 1, annotation);

            // Save the updated PDF.
            annotationEditor.Save(outputPath);
        }
        catch (Exception ex)
        {
            Console.Error.WriteLine($"Error updating annotations: {ex.Message}");
        }
    }
}